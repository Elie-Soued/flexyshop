<div class="container py-5" style="min-height: 62vh">
  <div
    class="d-flex justify-content-between align-items-center py-4 border-bottom"
  >
    <h3 class="mb-0 fw-bold">Shopping Basket</h3>
    <div>
      <button
        type="button"
        class="btn"
        title="Checkout"
        style="border: none"
        (click)="closeCheckoutView()"
      >
        <fa-icon [icon]="close" class="fs-3"></fa-icon>
      </button>
    </div>
  </div>

  @if(cart.length){
  <div class="mt-4" id="invoiceTable">
    @for(item of cart; track item.id){

    <div class="d-flex column">
      <div class="col-3">
        <img
          [src]="item.image"
          alt="{{ item.title }}"
          style="max-height: 80px"
        />
      </div>
      <div class="d-flex flex-column align-items-center col-6">
        <p class="fw-semibold">{{ item.buyCount }} x {{ item.title }}</p>
        <p>{{ item.price | currency : "EUR" }}</p>
        <p>{{ item.warranty }}</p>
        <p>{{ item.returnPolicy }}</p>

        <div
          class="input-group line-item-quantity-group quantity-selector-group w-auto mx-auto"
        >
          <button
            class="btn btn-dark"
            (click)="addItem(item)"
            [disabled]="outOfStock"
          >
            <fa-icon [icon]="add"></fa-icon>
          </button>
          <button class="btn btn-dark">{{ item.buyCount }}</button>
          <button class="btn btn-dark" [disabled]="item.buyCount === 1">
            <fa-icon
              [icon]="minus"
              (click)="reduceItemBuyCount(item)"
            ></fa-icon>
          </button>
        </div>

        @if(outOfStock){

        <div class="col-12 text-center p-2">
          <span class="badge bg-danger">Out of stock</span>
        </div>
        }
      </div>
      <div
        class="d-flex flex-column align-items-center justify-content-around col-3"
      >
        <button type="button" class="btn" (click)="removeItem(item)">
          <fa-icon [icon]="trash"></fa-icon>
        </button>
        <p>
          {{ item.price * item.buyCount | currency : "EUR" }}
        </p>
      </div>
    </div>

    <hr />

    }
  </div>

  <div class="mt-3">
    <div class="d-flex columns justify-content-between">
      <div>
        <p class="fw-semibold">Total</p>
        <p class="fw-semibold">Shipping costs</p>
      </div>
      <div>
        <p class="fw-semibold">
          {{ utilsService.getgrandTotal(cart) | currency : "EUR" }}
        </p>
        <p class="fw-semibold">{{ 0 | currency : "EUR" }}</p>
      </div>
    </div>

    <div class="d-flex column justify-content-center">
      <button
        class="btn btn-dark col-12"
        title="checkout"
        id="checkout"
        (click)="checkout()"
      >
        Proceed to checkout
      </button>
    </div>
  </div>

  }

  <!-- If cart is empty -->
  @else {
  <div class="text-center mt-5" id="emptyCart">
    <p class="text-muted fs-5">
      Your cart is empty :) Go do some shopping and come back!
    </p>
  </div>
  }
</div>
